(this["webpackJsonpcute-chat"]=this["webpackJsonpcute-chat"]||[]).push([[0],{51:function(e,t,n){},57:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n.n(c),r=n(31),s=n.n(r),o=n(6),i=n(36),u=n(8),l=n(18),j=n(1),d=a.a.createContext();function b(e){var t=Object(c.useState)({user:null,chatRooms:null,currentRoomId:null}),n=Object(l.a)(t,2),a=n[0],r=n[1];return Object(j.jsx)(d.Provider,{value:{global:a,setGlobal:r},children:e.children})}var h=n(3),m=(n(64),h.a.initializeApp({apiKey:"AIzaSyBQwYLNreWnwSEeNC3eOzr-2q-1PASglCI",authDomain:"cute-chat-43080.firebaseapp.com",projectId:"cute-chat-43080",storageBucket:"cute-chat-43080.appspot.com",messagingSenderId:"730231964779",appId:"1:730231964779:web:198ad75e908791fa541d2e"})),O=m.firestore(),f=n(32),x=n.n(f),v=(n(30),{signInFlow:"popup",signInOptions:[h.a.auth.GoogleAuthProvider.PROVIDER_ID,h.a.auth.EmailAuthProvider.PROVIDER_ID],callbacks:{signInSuccessWithAuthResult:function(){return!1}}});n(51);var g=function(){return Object(j.jsx)("div",{className:"container",children:Object(j.jsxs)("div",{className:"login-container elevated",children:[Object(j.jsx)("p",{className:"item title",children:"Login"}),Object(j.jsx)("div",{className:"item",children:Object(j.jsx)(x.a,{uiConfig:v,firebaseAuth:m.auth()})}),Object(j.jsx)("p",{className:"item dev",children:"Developed By: Asif Azad"})]})})},p=a.a.createContext();function y(e){var t=Object(c.useState)({searchIsOn:!1,focused:-1,breakPoint:1023}),n=Object(l.a)(t,2),a=n[0],r=n[1];return Object(j.jsx)(p.Provider,{value:{myStyle:a,setMyStyle:r},children:e.children})}function N(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}var C=function(){var e=Object(c.useState)(N()),t=Object(l.a)(e,2),n=t[0],a=t[1];return Object(c.useEffect)((function(){function e(){a(N())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),n};var I=function(e){var t=C().width,n=Object(c.useContext)(p),a=n.myStyle,r=n.setMyStyle,s=a.breakPoint,i=Object(c.useContext)(d),u=i.global,l=i.setGlobal,b=u.user,h=e.info,m=h.room_name,O=h.room_id,f=h.imgUrls,x=m[0]===b.displayName?m[1]:m[0],v=f[0]===b.photoURL?f[1]:f[0];return Object(j.jsxs)("button",{className:"chat-head elevated",onClick:function(){return l((function(e){return Object(o.a)(Object(o.a)({},e),{},{currentRoomId:O})})),void(t<=s&&r((function(e){return Object(o.a)(Object(o.a)({},e),{},{focused:0})})))},children:[Object(j.jsx)("img",{className:"avatar",src:v,alt:"avatar"}),Object(j.jsx)("p",{children:x})]})};var R=function(){var e=Object(c.useContext)(d).global,t=Object(c.useContext)(p).myStyle.focused,n=e.chatRooms.map((function(e){return Object(j.jsx)(I,{info:e},e.room_id)})),a={display:"block",gridArea:"focus"};return-1===t&&(a.gridArea="sidebar"),Object(j.jsx)("div",{className:"chat-sidebar pressed",style:0===t?{display:"none"}:a,children:n})};var S=function(e){var t=Object(c.useContext)(d).global.chatRooms;return null===e?null:t.findIndex((function(t){return t.room_id===e}))},w=n(16),k=n(12);var _=function(){var e=Object(c.useContext)(d).global.user;return Object(j.jsxs)("div",{className:"blank-room",children:[Object(j.jsx)("p",{style:{color:"var(--accent-col-2)"},children:"Welcome To CuteChat ".concat(e.displayName)}),Object(j.jsx)("div",{className:"faded-icon",children:Object(j.jsx)(w.a,{icon:k.b})})]})};var A=function(){var e=a.a.useContext(d).global,t=e.chatRooms,n=e.currentRoomId,c=e.user,r=S(n),s=a.a.useState(""),o=Object(l.a)(s,2),i=o[0],u=o[1];return Object(j.jsxs)("div",{className:"compose-text",children:[Object(j.jsx)("input",{className:"pressed",placeholder:"You are awesome",value:i,onChange:function(e){return function(e){u(e.target.value)}(e)}}),Object(j.jsx)("button",{className:"elevated rounded-btn",onClick:function(){var e=new Date,a={id:Date.now(),author:c.email,body:i,time:e.toLocaleTimeString()},s=t[r].texts;s.length>=20&&s.shift(),s.push(a),O.collection("cute_rooms").doc(n).update({texts:s}).then((function(){return console.log("success writing")})).catch((function(e){return console.log(e)})),u("")},children:Object(j.jsx)(w.a,{icon:k.c})})]})};var E=function(){var e,t,n=Object(c.useContext)(d).global,a=n.user,r=n.chatRooms,s=n.currentRoomId,o=S(s);if(null!==o){var i=r[o],u=i.room_name,l=i.imgUrls;e=u[0]===a.displayName?u[1]:u[0],t=l[0]===a.photoURL?l[1]:l[0]}return Object(j.jsxs)("div",{className:"inbox-header",children:[Object(j.jsx)("img",{className:"avatar elevated",src:t,alt:"avatar"}),Object(j.jsx)("p",{children:e})]})};var L=function(e){var t=Object(c.useContext)(d).global,n=t.chatRooms,a=t.currentRoomId,r=t.user,s=S(a),o=e.info,i=o.id,u=o.body,l=o.time,b=o.author,h=n[s],m=h.members,f=h.imgUrls[m.findIndex((function(e){return e===b}))],x={},v={marginLeft:"1rem"};return b===r.email&&(x={order:"2"},v={order:"1",marginRight:"1rem"}),Object(j.jsxs)("div",{className:"chat-text",style:b===r.email?{alignSelf:"flex-end"}:null,children:[Object(j.jsx)("img",{className:"avatar",src:f,style:x,alt:"avatar"}),Object(j.jsxs)("div",{className:"chat-text-content elevated",style:v,children:[Object(j.jsx)("p",{className:"chat-text-time",children:l}),Object(j.jsx)("p",{className:"chat-text-body",children:u}),b===r.email&&Object(j.jsx)("button",{className:"chat-text-delete",onClick:function(){var e=n[s].texts.filter((function(e){return e.id!==i}));O.collection("cute_rooms").doc(a).update({texts:e}).then((function(){return console.log("success writing")})).catch((function(e){return console.log(e)}))},children:Object(j.jsx)(w.a,{icon:k.f})})]})]})};var U=function(){var e=Object(c.useContext)(d).global,t=e.chatRooms,n=e.currentRoomId,a=S(n),r=Object(c.useRef)(null);return Object(c.useEffect)((function(){r.current.scrollTop=r.current.scrollHeight-r.current.clientHeight})),Object(j.jsx)("div",{className:"chat-texts",ref:r,children:t[a].texts.map((function(e){return Object(j.jsx)(L,{info:e},e.id)}))})};var z=function(){var e=Object(c.useContext)(p).myStyle.focused,t=Object(c.useContext)(d).global.currentRoomId,n=S(t),a={display:"grid",gridArea:"focus"};return-1===e&&(a.gridArea="box"),Object(j.jsx)("div",{className:"chat-box pressed",style:1===e?{display:"none"}:a,children:null===n?Object(j.jsx)(_,{}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(E,{}),Object(j.jsx)(U,{}),Object(j.jsx)(A,{})]})})},P=n(26),D=n.n(P),M=n(34),G=n(35);var T=function(e){var t=Object(c.useContext)(d),n=t.global,a=t.setGlobal,r=Object(c.useContext)(p).setMyStyle,s=n.chatRooms,i=n.user,u=e.info,l=u.name,b=u.email,h=u.imgUrl;function m(){return(m=Object(G.a)(D.a.mark((function e(){var t,n,c,u,j,d,m,f,x,v,g,p;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b!==i.email){e.next=4;break}return console.log("This is You!"),r((function(e){return Object(o.a)(Object(o.a)({},e),{},{searchIsOn:!1})})),e.abrupt("return");case 4:if(-1!==(t=s.findIndex((function(e){return e.members.includes(b)})))){e.next=20;break}return n=[i.displayName,l],c=[i.email,b],u=[i.photoURL,h],j={room_name:n,members:c,imgUrls:u,texts:[]},e.next=10,O.collection("cute_rooms").add(j);case 10:return d=e.sent,e.next=13,O.collection("cute_rooms").where("members","array-contains",i.email).get();case 13:m=e.sent,f=[],x=Object(M.a)(m.docs);try{for(x.s();!(v=x.n()).done;)g=v.value,f.push(Object(o.a)({room_id:g.id},g.data()))}catch(y){x.e(y)}finally{x.f()}a((function(e){return Object(o.a)(Object(o.a)({},e),{},{chatRooms:f,currentRoomId:d.id})})),e.next=22;break;case 20:p=s[t].room_id,a((function(e){return Object(o.a)(Object(o.a)({},e),{},{currentRoomInd:t,currentRoomId:p})}));case 22:r((function(e){return Object(o.a)(Object(o.a)({},e),{},{searchIsOn:!1})}));case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(j.jsxs)("button",{className:"search-result elevated",onClick:function(){return function(){return m.apply(this,arguments)}()},children:[Object(j.jsx)("img",{className:"avatar",src:h,alt:""}),Object(j.jsx)("p",{children:l})]})};var B=function(){var e=Object(c.useContext)(p),t=e.myStyle,n=e.setMyStyle,a=t.searchIsOn,r=Object(c.useState)(""),s=Object(l.a)(r,2),i=s[0],u=s[1],d=Object(c.useState)([]),b=Object(l.a)(d,2),h=b[0],m=b[1];return Object(j.jsxs)("div",{className:"search",children:[Object(j.jsx)("input",{className:"pressed",value:i,placeholder:"ex. Asif Azad",onChange:function(e){return function(e){u(e.target.value)}(e)}}),Object(j.jsx)("button",{className:"rounded-btn elevated",onClick:function(){i&&O.collection("cute_users").where("name","==",i.trim()).get().then((function(e){var t=[];e.forEach((function(e){t.push(Object(j.jsx)(T,{info:e.data()},e.id))})),m(t),n((function(e){return Object(o.a)(Object(o.a)({},e),{},{searchIsOn:!0})})),u("")}))},children:Object(j.jsx)(w.a,{icon:k.d})}),Object(j.jsx)("div",{className:"search-results",style:a?{display:"block"}:{display:"none"},children:0===h.length?Object(j.jsx)("div",{children:"No Matched Result"}):h})]})};var W=function(){var e=C().width;return Object(j.jsx)("button",{className:e<=400?"rounded-btn elevated":"logout elevated",onClick:function(){m.auth().signOut()},children:e<=480?Object(j.jsx)(w.a,{icon:k.e}):"Logout"})};var F=function(){var e=Object(c.useContext)(d).global.user;return Object(j.jsxs)("div",{className:"chat-header elevated",children:[Object(j.jsx)("img",{className:"avatar elevated",src:e.photoURL,alt:"avatar"}),Object(j.jsx)(B,{}),Object(j.jsx)(W,{})]})};var H=function(){var e=Object(c.useContext)(p).myStyle.searchIsOn;return Object(j.jsx)("div",{className:"greyout",style:e?{zIndex:"1"}:{zIndex:"-1"}})};var Y=function(){var e=Object(c.useContext)(p),t=e.myStyle,n=e.setMyStyle,a=t.focused;return Object(j.jsx)("div",{className:"chat-footer elevated",children:Object(j.jsx)("button",{className:"elevated rounded-btn",onClick:function(){n((function(e){var t=1-e.focused;return Object(o.a)(Object(o.a)({},e),{},{focused:t})}))},children:Object(j.jsx)(w.a,{icon:0===a?k.g:k.a})})})};n(57);var J=function(){var e=Object(c.useContext)(d),t=e.global,n=e.setGlobal,r=Object(c.useContext)(p),s=r.myStyle,i=r.setMyStyle,u=s.breakPoint,l=C().width,b=t.user,h=t.chatRooms;return Object(c.useEffect)((function(){i(l<=u?function(e){return Object(o.a)(Object(o.a)({},e),{},{focused:0})}:function(e){return Object(o.a)(Object(o.a)({},e),{},{focused:-1})})}),[l]),Object(c.useEffect)((function(){var e=O.collection("cute_rooms").where("members","array-contains",b.email).onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(o.a)({room_id:e.id},e.data()))})),n((function(e){return Object(o.a)(Object(o.a)({},e),{},{chatRooms:t})}))}));return function(){e()}}),[]),Object(j.jsx)(a.a.Fragment,{children:null===h?Object(j.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100vw",height:"100vh",fontSize:"1.5rem",backgroundColor:"var(--primary-col)"},children:Object(j.jsx)("p",{children:"Loading. . ."})}):Object(j.jsxs)("div",{className:"chat-container",children:[Object(j.jsx)(F,{}),Object(j.jsx)(R,{}),Object(j.jsx)(z,{}),Object(j.jsx)(Y,{}),Object(j.jsx)(H,{})]})})};var V=function(){var e=Object(c.useContext)(d),t=e.global,n=e.setGlobal,a=t.user;return Object(c.useEffect)((function(){var e=m.auth().onAuthStateChanged((function(e){if(n(null===e?function(e){return Object(o.a)(Object(o.a)({},e),{},{user:null,currentRoomId:null,chatRooms:null})}:function(t){return Object(o.a)(Object(o.a)({},t),{},{user:e})}),e&&m.auth().currentUser.metadata.creationTime===m.auth().currentUser.metadata.lastSignInTime){var t={name:e.displayName,email:e.email,imgUrl:e.photoURL};O.collection("cute_users").add(t).then((function(e){return console.log("".concat(e.id," and new user successfully in."))})).catch((function(e){return console.log("".concat(e," in writing new user in database."))}))}}));return function(){e()}}),[]),Object(j.jsx)(y,{children:Object(j.jsx)(i.a,{children:Object(j.jsx)(u.c,{children:Object(j.jsx)(u.a,{exact:!0,path:"/",children:a?Object(j.jsx)(J,{}):Object(j.jsx)(g,{})})})})})};s.a.render(Object(j.jsx)(a.a.StrictMode,{children:Object(j.jsx)(b,{children:Object(j.jsx)(V,{})})}),document.getElementById("root"))}},[[63,1,2]]]);
//# sourceMappingURL=main.a0b4cceb.chunk.js.map