(this["webpackJsonpcute-chat"]=this["webpackJsonpcute-chat"]||[]).push([[0],{51:function(e,t,c){},57:function(e,t,c){},63:function(e,t,c){"use strict";c.r(t);var n=c(2),a=c.n(n),r=c(32),o=c.n(r),s=c(6),i=c(36),u=c(8),l=c(18),j=c(1),d=a.a.createContext();function b(e){var t=Object(n.useState)({user:null,chatRooms:null,currentRoomId:null}),c=Object(l.a)(t,2),a=c[0],r=c[1];return Object(j.jsx)(d.Provider,{value:{global:a,setGlobal:r},children:e.children})}var h=c(3),O=(c(64),h.a.initializeApp({apiKey:"AIzaSyBQwYLNreWnwSEeNC3eOzr-2q-1PASglCI",authDomain:"cute-chat-43080.firebaseapp.com",projectId:"cute-chat-43080",storageBucket:"cute-chat-43080.appspot.com",messagingSenderId:"730231964779",appId:"1:730231964779:web:198ad75e908791fa541d2e"})),m=O.firestore(),f=c(33),x=c.n(f),v=(c(31),{signInFlow:"popup",signInOptions:[h.a.auth.GoogleAuthProvider.PROVIDER_ID,h.a.auth.EmailAuthProvider.PROVIDER_ID,h.a.auth.FacebookAuthProvider.PROVIDER_ID],callbacks:{signInSuccessWithAuthResult:function(){return!1}}});c(51);var g=function(){return Object(j.jsx)("div",{className:"container",children:Object(j.jsxs)("div",{className:"login-container elevated",children:[Object(j.jsx)("p",{className:"item title",children:"Login"}),Object(j.jsx)("div",{className:"item",children:Object(j.jsx)(x.a,{uiConfig:v,firebaseAuth:O.auth()})}),Object(j.jsx)("p",{className:"item dev",children:"Developed By: Asif Azad"})]})})},p=c(23),y=a.a.createContext();function C(e){var t=Object(n.useState)({searchIsOn:!1,focused:-1,breakPoint:1023}),c=Object(l.a)(t,2),a=c[0],r=c[1];return Object(j.jsx)(y.Provider,{value:{myStyle:a,setMyStyle:r},children:e.children})}function N(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}var I=function(){var e=Object(n.useState)(N()),t=Object(l.a)(e,2),c=t[0],a=t[1];return Object(n.useEffect)((function(){function e(){a(N())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),c};var R=function(e){var t=I().width,c=Object(n.useContext)(y),a=c.myStyle,r=c.setMyStyle,o=a.breakPoint,i=Object(n.useContext)(d).setGlobal,u=e.info,l=u.name,b=u.room_id,h=u.imgUrl,O=u.active,m=O?"Active":"Inactive";return Object(j.jsxs)("button",{style:O?{backgroundColor:"rgba(0, 255, 0, 0.3)"}:{backgroundColor:"rgba(255, 0, 0, 0.3)"},className:"chat-head elevated",onClick:function(){return i((function(e){return Object(s.a)(Object(s.a)({},e),{},{currentRoomId:b})})),void(t<=o&&r((function(e){return Object(s.a)(Object(s.a)({},e),{},{focused:0})})))},children:[Object(j.jsx)("img",{className:"avatar",src:h,alt:"avatar"}),Object(j.jsx)("p",{children:l}),Object(j.jsx)("p",{style:{fontSize:"var(--font-size-3)"},children:m})]})};var S=function(){var e=Object(n.useContext)(d).global,t=Object(n.useContext)(y).myStyle.focused,c=e.chatRooms.map((function(e){return Object(j.jsx)(R,{info:e},e.room_id)})),a={display:"block",gridArea:"focus"};return-1===t&&(a.gridArea="sidebar"),Object(j.jsx)("div",{className:"chat-sidebar pressed",style:0===t?{display:"none"}:a,children:c})};var w=function(e){var t=Object(n.useContext)(d).global.chatRooms;return null===e?null:t.findIndex((function(t){return t.room_id===e}))},k=c(16),_=c(12);var A=function(){var e=Object(n.useContext)(d).global.user;return Object(j.jsxs)("div",{className:"blank-room",children:[Object(j.jsx)("p",{style:{color:"var(--accent-col-2)"},children:"Welcome To CuteChat ".concat(e.displayName)}),Object(j.jsx)("div",{className:"faded-icon",children:Object(j.jsx)(k.a,{icon:_.b})})]})};var E=function(){var e=a.a.useContext(d).global,t=e.chatRooms,c=e.currentRoomId,n=e.user,r=w(c),o=a.a.useState(""),s=Object(l.a)(o,2),i=s[0],u=s[1];return Object(j.jsxs)("div",{className:"compose-text",children:[Object(j.jsx)("input",{className:"pressed",placeholder:"Write your message",value:i,onChange:function(e){return function(e){u(e.target.value)}(e)}}),Object(j.jsx)("button",{className:"elevated rounded-btn",onClick:function(){var e=new Date,a={id:Date.now(),author:n.email,body:i,time:e.toLocaleTimeString()},o=t[r].texts;o.length>=50&&o.shift(),o.push(a),m.collection("cute_rooms").doc(c).update({texts:o}).then((function(){return console.log("success writing")})).catch((function(e){return console.log(e)})),u("")},children:Object(j.jsx)(k.a,{icon:_.c})})]})};var P=function(){var e=Object(n.useContext)(d).global,t=(e.user,e.chatRooms),c=e.currentRoomId,a=t[w(c)],r=a.name,o=a.imgUrl;return Object(j.jsxs)("div",{className:"inbox-header",children:[Object(j.jsx)("img",{className:"avatar elevated",src:o,alt:"avatar"}),Object(j.jsx)("p",{children:r})]})};var U=function(e){var t=Object(n.useContext)(d).global,c=t.chatRooms,a=t.currentRoomId,r=t.user,o=w(a),s=e.info,i=s.id,u=s.body,l=s.time,b=s.author,h=b===O.auth().currentUser.email?O.auth().currentUser.photoURL:c[o].imgUrl,f={},x={marginLeft:"1rem"};return b===r.email&&(f={order:"2"},x={order:"1",marginRight:"1rem"}),Object(j.jsxs)("div",{className:"chat-text",style:b===r.email?{alignSelf:"flex-end"}:null,children:[Object(j.jsx)("img",{className:"avatar",src:h,style:f,alt:"avatar"}),Object(j.jsxs)("div",{className:"chat-text-content elevated",style:x,children:[Object(j.jsx)("p",{className:"chat-text-time",children:l}),Object(j.jsx)("p",{className:"chat-text-body",children:u}),b===r.email&&Object(j.jsx)("button",{className:"chat-text-delete",onClick:function(){var e=c[o].texts.filter((function(e){return e.id!==i}));m.collection("cute_rooms").doc(a).update({texts:e}).then((function(){return console.log("success writing")})).catch((function(e){return console.log(e)}))},children:Object(j.jsx)(k.a,{icon:_.f})})]})]})};var z=function(){var e,t=Object(n.useContext)(d).global,c=t.chatRooms,a=t.currentRoomId,r=w(a),o=Object(n.useRef)(null);return Object(n.useEffect)((function(){o.current.scrollTop=o.current.scrollHeight-o.current.clientHeight})),e=window.getComputedStyle(o.current).height,console.log("height: ".concat(e)),Object(j.jsxs)("div",{className:"chat-texts",ref:o,children:[Object(j.jsx)("h1",{children:e}),c[r].texts.map((function(e){return Object(j.jsx)(U,{info:e},e.id)}))]})};var L=function(){var e=Object(n.useContext)(y).myStyle.focused,t=Object(n.useContext)(d).global.currentRoomId,c=w(t),a={display:"grid",gridArea:"focus"};return-1===e&&(a.gridArea="box"),Object(j.jsx)("div",{className:"chat-box pressed",style:1===e?{display:"none"}:a,children:null===c?Object(j.jsx)(A,{}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(P,{}),Object(j.jsx)(z,{}),Object(j.jsx)(E,{})]})})},D=c(27),M=c.n(D),G=c(35);var W=function(e){var t=Object(n.useContext)(d),c=t.global,a=t.setGlobal,r=Object(n.useContext)(y).setMyStyle,o=c.chatRooms,i=c.user,u=e.info,l=u.name,b=u.email,h=u.imgUrl;function O(){return(O=Object(G.a)(M.a.mark((function e(){var t,c,n,u,l,j,d,h,O,f;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b!==i.email){e.next=4;break}return console.log("This is You!"),r((function(e){return Object(s.a)(Object(s.a)({},e),{},{searchIsOn:!1})})),e.abrupt("return");case 4:if(-1!==(t=o.findIndex((function(e){return e.members.includes(b)})))){e.next=20;break}return c=[i.email,b],n={members:c,texts:[]},e.next=10,m.collection("cute_rooms").add(n);case 10:return u=e.sent,e.next=13,m.collection("cute_rooms").where("members","array-contains",i.email).get();case 13:l=e.sent,j=[],d=Object(p.a)(l.docs);try{for(d.s();!(h=d.n()).done;)O=h.value,j.push(Object(s.a)({room_id:O.id},O.data()))}catch(x){d.e(x)}finally{d.f()}a((function(e){return Object(s.a)(Object(s.a)({},e),{},{chatRooms:j,currentRoomId:u.id})})),e.next=22;break;case 20:f=o[t].room_id,a((function(e){return Object(s.a)(Object(s.a)({},e),{},{currentRoomInd:t,currentRoomId:f})}));case 22:r((function(e){return Object(s.a)(Object(s.a)({},e),{},{searchIsOn:!1})}));case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(j.jsxs)("button",{className:"search-result elevated",onClick:function(){return function(){return O.apply(this,arguments)}()},children:[Object(j.jsx)("img",{className:"avatar",src:h,alt:""}),Object(j.jsx)("p",{children:l})]})};var B=function(){var e=Object(n.useContext)(y),t=e.myStyle,c=e.setMyStyle,a=t.searchIsOn,r=Object(n.useState)(""),o=Object(l.a)(r,2),i=o[0],u=o[1],d=Object(n.useState)([]),b=Object(l.a)(d,2),h=b[0],O=b[1];return Object(j.jsxs)("div",{className:"search",children:[Object(j.jsx)("input",{className:"pressed",value:i,placeholder:"Search",onChange:function(e){return function(e){u(e.target.value)}(e)}}),Object(j.jsx)("button",{className:"rounded-btn elevated",onClick:function(){i&&m.collection("cute_users").where("name","==",i.trim()).get().then((function(e){var t=[];e.forEach((function(e){t.push(Object(j.jsx)(W,{info:e.data()},e.id))})),O(t),c((function(e){return Object(s.a)(Object(s.a)({},e),{},{searchIsOn:!0})})),u("")}))},children:Object(j.jsx)(k.a,{icon:_.d})}),Object(j.jsx)("div",{className:"search-results",style:a?{display:"block"}:{display:"none"},children:0===h.length?Object(j.jsx)("div",{children:"No Matched Result"}):h})]})};var F=function(){var e=I().width;return Object(j.jsx)("button",{className:e<=400?"rounded-btn elevated":"logout elevated",onClick:function(){var e=O.auth().currentUser.uid;O.auth().signOut().then((function(){m.collection("cute_users").doc(e).update({active:!1}).then((function(){return console.log("active status changed")})).catch((function(e){return console.log("".concat(e," in chaging active status in database."))}))}))},children:e<=480?Object(j.jsx)(k.a,{icon:_.e}):"Logout"})};var T=function(){var e=Object(n.useContext)(d).global.user;return Object(j.jsxs)("div",{className:"chat-header elevated",children:[Object(j.jsx)("img",{className:"avatar elevated",src:e.photoURL,alt:"avatar"}),Object(j.jsx)(B,{}),Object(j.jsx)(F,{})]})};var H=function(){var e=Object(n.useContext)(y).myStyle.searchIsOn;return Object(j.jsx)("div",{className:"greyout",style:e?{zIndex:"1"}:{zIndex:"-1"}})};var J=function(){var e=Object(n.useContext)(y),t=e.myStyle,c=e.setMyStyle,a=t.focused;return Object(j.jsx)("div",{className:"chat-footer elevated",children:Object(j.jsx)("button",{className:"elevated rounded-btn",onClick:function(){c((function(e){var t=1-e.focused;return Object(s.a)(Object(s.a)({},e),{},{focused:t})}))},children:Object(j.jsx)(k.a,{icon:0===a?_.g:_.a})})})};c(57);var V=function(){var e=Object(n.useContext)(d),t=e.global,c=e.setGlobal,r=Object(n.useContext)(y),o=r.myStyle,i=r.setMyStyle,u=o.breakPoint,l=I().width,b=t.user,h=t.chatRooms;return Object(n.useEffect)((function(){i(l<=u?function(e){return Object(s.a)(Object(s.a)({},e),{},{focused:0})}:function(e){return Object(s.a)(Object(s.a)({},e),{},{focused:-1})})}),[l]),Object(n.useEffect)((function(){var e=[],t=m.collection("cute_rooms").where("members","array-contains",b.email).onSnapshot((function(t){var n=[];t.forEach((function(e){n.push(Object(s.a)({room_id:e.id},e.data()))})),0===n.length&&c((function(e){return Object(s.a)(Object(s.a)({},e),{},{chatRooms:n})}));var a=function(t){var a=n[t].members[0]===b.email?n[t].members[1]:n[t].members[0];e.push(m.collection("cute_users").where("email","==",a).onSnapshot((function(e){e.forEach((function(e){console.log("\n\n\nuser ".concat(JSON.stringify(e))),n[t]=Object(s.a)(Object(s.a)({},e.data()),n[t]),t==n.length-1&&c((function(e){return Object(s.a)(Object(s.a)({},e),{},{chatRooms:n})}))}))})))};for(var r in n)a(r)}));return function(){t();var c,n=Object(p.a)(e);try{for(n.s();!(c=n.n()).done;){(0,c.value)()}}catch(a){n.e(a)}finally{n.f()}}}),[]),Object(j.jsx)(a.a.Fragment,{children:null===h?Object(j.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100vw",height:"100vh",fontSize:"1.5rem",backgroundColor:"var(--primary-col)"},children:Object(j.jsx)("p",{children:"Loading. . ."})}):Object(j.jsxs)("div",{className:"chat-container",children:[Object(j.jsx)(T,{}),Object(j.jsx)(S,{}),Object(j.jsx)(L,{}),Object(j.jsx)(J,{}),Object(j.jsx)(H,{})]})})};var Y=function(){var e=Object(n.useContext)(d),t=e.global,c=e.setGlobal,a=t.user;return Object(n.useEffect)((function(){var e=O.auth().onAuthStateChanged((function(e){if(c(null===e?function(e){return Object(s.a)(Object(s.a)({},e),{},{user:null,currentRoomId:null,chatRooms:null})}:function(t){return Object(s.a)(Object(s.a)({},t),{},{user:e})}),e){var t={active:!0,name:e.displayName,email:e.email,imgUrl:e.photoURL};m.collection("cute_users").doc(O.auth().currentUser.uid).set(t).then((function(){return console.log(" new user successfully in.")})).catch((function(e){return console.log("".concat(e," in writing new user in database."))}))}}));return function(){e()}}),[]),Object(j.jsx)(C,{children:Object(j.jsx)(i.a,{children:Object(j.jsx)(u.c,{children:Object(j.jsx)(u.a,{exact:!0,path:"/",children:a?Object(j.jsx)(V,{}):Object(j.jsx)(g,{})})})})})};o.a.render(Object(j.jsx)(a.a.StrictMode,{children:Object(j.jsx)(b,{children:Object(j.jsx)(Y,{})})}),document.getElementById("root"))}},[[63,1,2]]]);
//# sourceMappingURL=main.20ce28aa.chunk.js.map